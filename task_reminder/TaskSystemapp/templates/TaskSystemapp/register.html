{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>User Register</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    .auth-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f8f9fa;
    }
    .auth-card {
      width: 100%;
      max-width: 400px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.08);
      padding: 2rem;
      margin: 20px;
    }
    .auth-title {
      text-align: center;
      margin-bottom: 2rem;
      color: #2c3e50;
      font-size: 1.8rem;
      font-weight: 600;
    }
    .form-group {
      margin-bottom: 1.5rem;
    }
    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      color: #495057;
      font-weight: 500;
    }
    .submit-btn {
      width: 100%;
      padding: 0.75rem;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    .submit-btn:hover {
      background: #0056b3;
      transform: translateY(-2px);
    }
    .switch-link {
      text-align: center;
      margin-top: 1.5rem;
      color: #6c757d;
    }
    .switch-link a {
      color: #007bff;
      text-decoration: none;
      font-weight: 500;
    }
    .error-message {
      color: #dc3545;
      font-size: 0.875rem;
      margin-top: 0.5rem;
      padding-left: 0.25rem;
    }
  </style>
</head>
<body>
  <div class="auth-container">
    <div class="auth-card">
      <h2 class="auth-title">User Register</h2>
      <div id="clientErrors" class="error-message">
        {% if form.errors %}
          {% for field in form %}
            {% for error in field.errors %}
              {{ error }}<br>
            {% endfor %}
          {% endfor %}
          {% for error in form.non_field_errors %}
            {{ error }}<br>
          {% endfor %}
        {% endif %}
      </div>
      <form method="post" enctype="multipart/form-data" novalidate id="registerForm">
        {% csrf_token %}
        <div class="form-group">
          <label class="form-label">Username</label>
          <input type="text" class="form-control" name="username" placeholder="Enter your username" value="{{ form.username.value|default_if_none:'' }}" required>
        </div>
        <div class="form-group">
          <label class="form-label">E-mail</label>
          <input type="email" class="form-control" name="email" placeholder="Enter a valid email address" value="{{ form.email.value|default_if_none:'' }}" required>
        </div>
        <div class="form-group">
          <label class="form-label">Password</label>
          <input type="password" class="form-control" name="password1" placeholder="Enter your password" required>
        </div>
        <div class="form-group">
          <label class="form-label">Confirm password</label>
          <input type="password" class="form-control" name="password2" placeholder="Confirm your password" required>
        </div>
        <div class="form-group">
          <label class="form-label">Telephone number</label>
          <input type="text" class="form-control" name="phone" placeholder="Enter your telephone number in international format" value="{{ form.phone.value|default_if_none:'' }}" required>
        </div>
        <div class="form-group">
          <label class="form-label">Region</label>
          <select class="form-control" name="region" required>
            <option value="">Please select a region</option>
            <option value="Asia/Shanghai" {% if form.region.value == "Asia/Shanghai" %}selected{% endif %}>Beijing (UTC+8)</option>
            <option value="Asia/Tokyo" {% if form.region.value == "Asia/Tokyo" %}selected{% endif %}>Tokyo (UTC+9)</option>
            <option value="Asia/Singapore" {% if form.region.value == "Asia/Singapore" %}selected{% endif %}>Singapore (UTC+8)</option>
            <option value="America/New_York" {% if form.region.value == "America/New_York" %}selected{% endif %}>New York (UTC-5)</option>
            <option value="Europe/London" {% if form.region.value == "Europe/London" %}selected{% endif %}>London (UTC+0)</option>
            <option value="Australia/Sydney" {% if form.region.value == "Australia/Sydney" %}selected{% endif %}>Sydney (UTC+10)</option>
          </select>
        </div>
        <button type="submit" class="submit-btn">Submit</button>
        <div class="switch-link">
          Existing accounts? <a href="{% url 'login' %}">Sign in now</a>
        </div>
      </form>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var form = document.getElementById('registerForm');
      form.addEventListener('submit', function(e) {
        var errors = [];
        var username = form.elements['username'].value.trim();
        if (!username) {
          errors.push("Please enter your username.");
        }
        var email = form.elements['email'].value.trim();
        if (!email) {
          errors.push("Please enter your email address.");
        } else {
          if (!email.includes('@')) {
            errors.push("Email address must contain '@'.");
          }
          if (!email.includes('.com')) {
            errors.push("Email address must contain '.com'.");
          }
          var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (!emailRegex.test(email)) {
            errors.push("Please enter a valid email address.");
          }
        }
        var password1 = form.elements['password1'].value;
        if (!password1) {
          errors.push("Please enter your password.");
        }
        var password2 = form.elements['password2'].value;
        if (!password2) {
          errors.push("Please confirm your password.");
        }
        if (password1 && password2 && password1 !== password2) {
          errors.push("Passwords do not match.");
        }
        var phone = form.elements['phone'].value.trim();
        if (!phone) {
          errors.push("Please enter your telephone number.");
        } else if (!phone.startsWith('+')) {
          errors.push("Please use the international format (e.g., starting with +44).");
        }
        var region = form.elements['region'].value;
        if (!region) {
          errors.push("Please select a region.");
        }
        if (errors.length > 0) {
          e.preventDefault();
          document.getElementById('clientErrors').innerHTML = errors.join("<br>");
        }
      });
    });
  </script>
</body>
</html>
